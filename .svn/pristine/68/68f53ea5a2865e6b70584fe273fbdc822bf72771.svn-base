{% extends 'base.html' %}
{% block content %}
{% load staticfiles %}

<div class="graphs_container">
<!-- side menu must be on top for 'float' to work properly -->
<div class="side_menu">
    <!-- div classes are used to style these menu items,
         ids are used for accordion jQuery functions. -->
    
    <!-- the search box. specific functionality to be determined.
         Based on Bootstrap CSS API -->
    <div class="search_box">
        <form method="get" role="form"> 
            <div class="input-group">
                <!--<input class="form-control" type="text" name="search">-->
                {{ search_form }}
                <span class="input-group-btn">
                    <button class="btn btn-info" type="submit">Search</button>
                </span>
            </div>
        </form>
    </div>

    <!-- Tags menu -->
    <div id="accordion_tags" class="accordion">
        <h3>Tags</h3>
        <div class="accordion_content">
            under construction
        </div>
    </div>
</div> <!-- end class = side_menu -->

{% if uid != None %}
<!-- A user is logged in. display relevant links for Graphs page -->
<div class="graph_links">
    <!-- using Bootstrap button API -->
    <div class="btn-group">
        <a href="{% url 'graphs' %}">My Graphs</a>
        <a href="{% url 'shared_graphs' %}">Shared with me</a>
        <a href="{% url 'public_graphs' %}">Public Graphs</a>
        <!-- All Graphs is for admin mode. Specific functionality to be added. -->
        <a href="{% url 'all_graphs' %}">All Graphs</a>
    </div>
</div>
{% else %}
<!-- A user is not logged in. display a link for public graphs -->
<div class="graph_links">
    <a href="{% url 'public_graphs' %}">Public Graphs</a>
</div>
{% endif %}

<!-- pagination of list of graphs.
     See util/paginator.py for details. -->
<div class="pager">
    {% if graph_list != None %}
    {% if has_previous %}
    <span class="page">
        <a href="?page={{ previous_page_number }}">&lt; Prev</a>
    </span>
    {% endif %}
    
    {% if show_first %}
        <span class="page"><a href="?page=1">1</a></span>
        <span class="ellipsis">...</span>
    {% endif %}

    {% for p in page_numbers %}
        {% if p == current_page.number %}
            <span class="current">{{ current_page.number }}</span>
        {% else %}
            <span class="page"><a href="?page={{ p }}">{{ p }}</a></span>
        {% endif %}
    {% endfor %}
    
    {% if show_last %}
        <span class="ellipsis">...</span>
        <span class="page"><a href="?page={{ paginator.num_pages }}">{{ paginator.num_pages }}</a></span>
    {% endif %}

    {% if has_next %}
        <span class="page"><a href="?page={{ next_page_number }}">Next &gt;</a></span> 
    {% endif %}
    {% endif %}
</div>

<!-- list of graphs from database displayed in table form -->
<div class="results_table">
<table>
{% if graph_list != None %}
    <!-- list search results -->
    {% if search_result %}
        {% if current_page != None %}
        <tr>
            <td>Graph ID</td>
            <td>User ID</td>
            <td>Node ID</td>
            <td>Node Label</td>
        </tr>
        {% for g in current_page %}
        <tr> 
            <td><a href="{% url 'view_graph' uid=g.1 gid=g.0 %}">{{ g.0 }}</a></td>
            <td>{{ g.1 }}</td>
            <td>{{ g.2 }}</td>
            <td>{{ g.3 }}</td>
        </tr>
        {% endfor %}
        {% endif %}

    <!-- list graphs -->
    {% else %}
        {% if current_page != None %}
        <tr>
            <td>Graph ID</td>
            <td>Modified</td>
            <td>Owner</td>
            <td>Visibility</td>
        </tr>
        {% for g in current_page %}
        <tr> 
            <td><a href="{% url 'view_graph' uid=g.2 gid=g.0 %}">{{ g.0 }}</a></td>
            <td>{{ g.1 }}</td>
            <td>{{ g.2 }}</td>
            {% if g.3 == 1 %}
            <td>Public</td>
            {% else %}
            <td>Private</td>
            {% endif %}
        </tr>
        {% endfor %}
        {% endif %}
    {% endif %}
{% else %}
    <p>No graphs to list</p>
{% endif %}
</table>
</div> <!-- end results_table -->
</div> <!-- end graphs_container -->
{% endblock %} <!-- end content block -->

{% block css-js-footer %}
<!-- load javascripts -->
<!-- javascript for side menu -->
<script type="text/javascript" src="{% static 'graphs/js/graphs.js' %}"></script>

<!--jQuery UI, needed for side menu -->
<script type="text/javascript" src="{% static 'graphs/js/jquery-ui.min.js' %}"></script>

<!-- JSON support for IE (needed to use JS API) -->
<script type="text/javascript" src="{% static 'graphs/json2.min.js' %}"></script>

<!-- load stylesheets -->
<!-- jQuery UI style sheet -->
<link rel="stylesheet" href="{% static 'graphs/css/jquery-ui.min.css' %}">

<!-- stylesheet for pager -->
<link href="{% static 'graphs/css/pager.css' %}" rel="stylesheet">

<!-- stylesheet for elements specified in this html(graphs.html) -->
<link rel="stylesheet" type="text/css" href="{% static 'graphs/css/graphs.css' %}">

<!-- stylesheet for side menues -->
<link rel="stylesheet" type="text/css" href="{% static 'graphs/css/side_menu.css' %}">

{% endblock %}